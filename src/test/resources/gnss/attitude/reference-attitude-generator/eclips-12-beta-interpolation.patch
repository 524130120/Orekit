--- eclips_May2017.f	2018-09-06 08:07:16.873861836 +0200
+++ eclips_May2017_patched.f	2018-09-06 08:44:59.625795677 +0200
@@ -112,6 +112,9 @@
 C                      Jul 12, 2018  UPDATE ESTIMATED ECLIPSE START AND END TIME
 C                                    WHEN THEY ARE ESTIMATED FROM A CLOSER
 C                                    DATE THAN PREVIOUS ESTIME (Luc Maisonobe)
+C                      Sep 06, 2018  USE LINEAR INTERPOLATION MODEL FOR BETA TO
+C                                    REDUCE RESULT SENSITIVITY TO SAMPLING RATE
+C                                    INDUCED BY CALLING ROUTINE (Luc Maisonobe)
 C
 C     PARAMETERS        DESCRIPTION
 C        IDIR           DIRECTION OF PROCESSING (1=FORWARD, -1=BACKWARD)
@@ -213,6 +216,7 @@
       REAL*8    DABS, ABS, SIGN, DMOD, MAX, MIN
       REAL*8    SGAP(MAXSAT, MAXECL), EGAP(MAXSAT, MAXECL)
       REAL*8    CGAP(MAXSAT, MAXECL), ECLCTM(MAXSAT,MAXECL)
+      REAL*8    BTTAG(MAXSAT, 2), BSMPL(MAXSAT, 2), BINTRP
 C Dec 12, 2013
       REAL*8 YBIAS
       INTEGER*4 IBLK(*), J, I
@@ -234,7 +238,7 @@
 C                Note: THE BEIDOU HARDWARE RATES NOT NEEDED
 C    &  ,.1140d0, 32*0.250d0/
      &  ,.1140d0, 32*0.250d0, 36*0.203d0, 36*0.203d0/
-      SAVE SGAP, EGAP, CGAP, ECLCTM
+      SAVE SGAP, EGAP, CGAP, ECLCTM, BTTAG, BSMPL
 C     Jan 10, 2017
 C     GAL  BETAy => BETA0
 C     GAL  BETAx => ANOON=15DEG:  (ANIGHT-180); ANIGHT =180 + 15 DEG
@@ -291,7 +295,14 @@
 C
       NOON=.FALSE.
       NIGHT=.FALSE.
-      BETADG = beta/DTR - 90.d0 
+      BETADG = beta/DTR - 90.d0
+C
+C     SAVE LAST TWO VALUES OF BETA FOR INTERPOLATION MODEL
+      BTTAG(IPRN, 2) = BTTAG(IPRN, 1)
+      BSMPL(IPRN, 2) = BSMPL(IPRN, 1)
+      BTTAG(IPRN, 1) = TTAG
+      BSMPL(IPRN, 1) = BETADG
+C
 C Mar 09, 2016
 C      IF(IPRN.GT.32.AND.ABS(BETADG).LT.ANOON) THEN
        IF(IPRN.GT.32.AND.IPRN.LE.64.AND.ABS(BETADG).LT.ANOON) THEN
@@ -468,7 +479,11 @@
 C Feb 27, 2017
 C SET GPS, GLN, GAL BETAINI IF APPLICABLE, I.E. FWD & |BETA| =< 0.07 DEG
             IF(IDIR.GT.0.AND.IPRN.LE.100.AND.ABS(BETADG).LE.0.07D0
-     &         .AND.BETAINI(IPRN).EQ.0.D0) BETAINI(IPRN)= BETADG
+     &          .AND.BETAINI(IPRN).EQ.0.D0) THEN
+C              SET TO THE BETA VALUE INTERPOLATED AT TURN START
+               BETAINI(IPRN)= BINTRP(IPRN, ECLSTM(IPRN, NECLIPS(IPRN)),
+     &                               BTTAG, BSMPL)
+            ENDIF
 C IIR MIDNIGHT/NOON TURN  or II/IIA NOON TURN START
 C                                  AND GLONASS NOON
             IF(IBLK(IPRN).GT.3.AND.IBLK(IPRN).LE.5.OR.NOON) THEN
@@ -847,3 +862,39 @@
       ENDIF
       RETURN
       END
+C
+      DOUBLE PRECISION FUNCTION BINTRP(IPRN, TTAG, BTTAG, BSMPL)
+C     NAME           BINTRP
+C
+C     PURPOSE        INTERPOLATE THE BETA ANGLE TO SPECIFIED DATE
+C                    THIS ENSURES THAT THE COMPUTATION OF TURN START
+C                    CONDITION REMAIN INDEPENDENT OF SAMPLING RATE
+C                    INDUCED BY THE ROUTINE CALLING ECLIPS
+C
+C     PARAMETERS     DESCRIPTION
+C     IPRN           SV PRN NUMBER
+C     TTAG           OBSERVATION EPOCH TIME TAG (EG SEC OF GPS WEEK)
+C     BTTAG          TIME OF SAMPLED BETA VALUES
+C     BSMPL          SAMPLED BETA VALUES
+C
+C     RETURN         BETA INTERPOLATED AT TTAG
+C
+      IMPLICIT NONE
+      INTEGER   MAXSAT
+      PARAMETER (MAXSAT=136)
+      INTEGER*4 IPRN
+      REAL*8    TTAG, BTTAG(MAXSAT, 2), BSMPL(MAXSAT, 2)
+      REAL*8    T01, T20, T21
+C
+      IF (BTTAG(IPRN, 2) .EQ. 0.0D0) THEN
+C         WE HAVE ONLY ONE POINT YET, NO INTERPOLATION
+          BINTRP = BSMPL(IPRN, 1)
+      ELSE
+C         WE HAVE TWO POINTS, WE INTERPOLATE LINEARLY
+         T01    = TTAG - BTTAG(IPRN, 1)
+         T20    = BTTAG(IPRN, 2) - TTAG
+         T21    = BTTAG(IPRN, 2) - BTTAG(IPRN, 1)
+         BINTRP = (BSMPL(IPRN, 1) * T20 + BSMPL(IPRN, 2) * T01) / T21
+      ENDIF
+      RETURN
+      END
