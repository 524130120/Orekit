--- eclips_Dec2017.f.orig	2018-09-21 17:50:58.947354695 +0200
+++ eclips_Dec2017.f	2018-09-21 17:51:23.227141405 +0200
@@ -120,6 +120,9 @@
 C                      Jul 12, 2018  UPDATE ESTIMATED ECLIPSE START AND END TIME
 C                                    WHEN THEY ARE ESTIMATED FROM A CLOSER
 C                                    DATE THAN PREVIOUS ESTIME (Luc Maisonobe)
+C                      Sep 06, 2018  USE LINEAR INTERPOLATION MODEL FOR BETA TO
+C                                    REDUCE RESULT SENSITIVITY TO SAMPLING RATE
+C                                    INDUCED BY CALLING ROUTINE (Luc Maisonobe)
 C                      Sep 14, 2018  FIXED BODY-X UNIT VECTOR COMPUTATION
 C                                    EXACTLY AT NODE (AVOID NaNs), IMPROVE
 C                                    ITS ACCURACY FOR NON-PERFECTLY CIRCULAR
@@ -244,6 +247,7 @@
       REAL*8    DABS, ABS, SIGN, DMOD, MAX, MIN
       REAL*8    SGAP(MAXSAT, MAXECL), EGAP(MAXSAT, MAXECL)
       REAL*8    ECLCTM(MAXSAT,MAXECL)
+      REAL*8    BTTAG(MAXSAT, 2), BSMPL(MAXSAT, 2), BINTRP
 C Dec 12, 2013
       REAL*8 YBIAS
       INTEGER*4 IBLK(*), J, I
@@ -271,7 +275,7 @@
 C    &  ,.1140d0, 32*0.250d0, 36*0.203d0, 36*0.203d0/
 C BEIDOU RATES OF 0.085 & 0.158 ACCORDING TO DILSSNER (Nov 2017) 
      &  ,.1140d0, 32*0.250d0, 36*0.203d0, 10*0.085D0, 26*0.158d0/
-      SAVE SGAP, EGAP, ECLCTM
+      SAVE SGAP, EGAP, ECLCTM, BTTAG, BSMPL
 C Jan 10, 2017
 C     GAL  BETAy => BETA0
 C     GAL  BETAx => ANOON=15DEG:  (ANIGHT-180); ANIGHT =180 + 15 DEG
@@ -370,7 +374,14 @@
 C
       NOON=.FALSE.
       NIGHT=.FALSE.
-      BETADG = beta/DTR - 90.d0 
+      BETADG = beta/DTR - 90.d0
+C
+C     SAVE LAST TWO VALUES OF BETA FOR INTERPOLATION MODEL
+      BTTAG(IPRN, 2) = BTTAG(IPRN, 1)
+      BSMPL(IPRN, 2) = BSMPL(IPRN, 1)
+      BTTAG(IPRN, 1) = TTAG
+      BSMPL(IPRN, 1) = BETADG
+C
 C Mar 09, 2016
 C      IF(IPRN.GT.32.AND.ABS(BETADG).LT.ANOON) THEN
        IF(IPRN.GT.32.AND.IPRN.LE.64.AND.ABS(BETADG).LT.ANOON) THEN
@@ -641,7 +652,11 @@
 C           IF(IDIR.GT.0.AND.IPRN.LE.100.AND.ABS(BETADG).LE.0.07D0
          IF(IDIR.GT.0.AND.(IPRN.LE.100.OR.IPRN.EQ.INPRN)
      &     .AND.ABS(BETADG).LE.0.07D0
-     &     .AND.BETAINI(IPRN).EQ.0.D0) BETAINI(IPRN)= BETADG
+     &     .AND.BETAINI(IPRN).EQ.0.D0) THEN
+C            SET TO THE BETA VALUE INTERPOLATED AT TURN START
+             BETAINI(IPRN)= BINTRP(IPRN, ECLSTM(IPRN, NECLIPS(IPRN)),
+     &                             BTTAG, BSMPL)
+         ENDIF
 C IIR MIDNIGHT/NOON TURN  or II/IIA NOON TURN START
 C                                  AND GLONASS NOON
             IF(IBLK(IPRN).GT.3.AND.IBLK(IPRN).LE.5.OR.NOON) THEN
@@ -1028,3 +1043,39 @@
       ENDIF
       RETURN
       END
+C
+      DOUBLE PRECISION FUNCTION BINTRP(IPRN, TTAG, BTTAG, BSMPL)
+C     NAME           BINTRP
+C
+C     PURPOSE        INTERPOLATE THE BETA ANGLE TO SPECIFIED DATE
+C                    THIS ENSURES THAT THE COMPUTATION OF TURN START
+C                    CONDITION REMAIN INDEPENDENT OF SAMPLING RATE
+C                    INDUCED BY THE ROUTINE CALLING ECLIPS
+C
+C     PARAMETERS     DESCRIPTION
+C     IPRN           SV PRN NUMBER
+C     TTAG           OBSERVATION EPOCH TIME TAG (EG SEC OF GPS WEEK)
+C     BTTAG          TIME OF SAMPLED BETA VALUES
+C     BSMPL          SAMPLED BETA VALUES
+C
+C     RETURN         BETA INTERPOLATED AT TTAG
+C
+      IMPLICIT NONE
+      INTEGER   MAXSAT
+      PARAMETER (MAXSAT=136)
+      INTEGER*4 IPRN
+      REAL*8    TTAG, BTTAG(MAXSAT, 2), BSMPL(MAXSAT, 2)
+      REAL*8    T01, T20, T21
+C
+      IF (BTTAG(IPRN, 2) .EQ. 0.0D0) THEN
+C         WE HAVE ONLY ONE POINT YET, NO INTERPOLATION
+          BINTRP = BSMPL(IPRN, 1)
+      ELSE
+C         WE HAVE TWO POINTS, WE INTERPOLATE LINEARLY
+         T01    = TTAG - BTTAG(IPRN, 1)
+         T20    = BTTAG(IPRN, 2) - TTAG
+         T21    = BTTAG(IPRN, 2) - BTTAG(IPRN, 1)
+         BINTRP = (BSMPL(IPRN, 1) * T20 + BSMPL(IPRN, 2) * T01) / T21
+      ENDIF
+      RETURN
+      END
